/**
 * jQuery.rating - 5 star rating plugin
 * Copyright (c) Ennexa Technologies (P) Ltd | http://www.ennexa.com/
 * Dual licensed under MIT and GPL.
 * @version 2.0.0
 */

(function(c,k){var h=function(d,b){this.init(d,b)};c.extend(h,{defaults:{id:null,rated:!1,value:null,url:"/api/rating.json",change:function(d,b){var a=b.options,e=a.id,g=a.value;a.xhr&&a.xhr.abort();setTimeout(function(){var f=e.match(/(.*)-(\d+)/);a.xhr=c.post(a.url,{item_section:f[1],item_id:f[2],rating_value:g},function(f){"OK"===f.status?(c.cookie("rating."+e,g,c.extend({path:null,expires:30},a.cookie)),b.options.rated=!0,c(d.target).rating("refresh")):c.error(f.message)})},500)},init:function(d,
b){var a=b.options,e=c.cookie("rating."+a.id);e&&(a.value=parseInt(e,10),a.rated=!0)},emptyClass:"icon icon-star-o",fillClass:"icon icon-star",hoverClass:"icon icon-star",activeClass:"icon icon-star"},ns:function(){return"com.ennexa.rating"},prototype:{init:function(d,b){var a=this,e;this.$elem=e=c(d).prop("type","hidden");b.id=b.id||d.id||"";b.value=parseInt(b.value,10)||parseInt(e.val(),10);b.id&&!isNaN(b.value)&&(this.options=b,this.$wrapper=c('<span class="star-rating"><a/><a/><a/><a/><a/></span>').insertBefore(e),
this.$wrapper.children().prop("href","#").addClass("star-rating-star").append("\u2605"),e.on("change.com.ennexa.rating",function(){a.update(a.$elem.val())}),this.$wrapper.on("click touchstart",".star-rating-star",function(a){a.stopPropagation();a.preventDefault();e.val(c(this).index()+1).trigger("change.com.ennexa.rating")}).on("mouseenter",".star-rating-star",function(){a.fill(c(this).index()+1,!0)}).on("mouseleave",function(){a.fill(a.$elem.val(),!1)}),e.on("ratinginit.com.ennexa.rating",b.init).on("ratingchange.com.ennexa.rating",
b.change).trigger("ratinginit.com.ennexa.rating",{options:b}),this.fill(b.value))},refresh:function(d){this.fill(this.options.value=this.$elem.val())},update:function(d){var b=this.options.value;this.fill(d,!1);this.options.value=d;this.$elem.trigger("ratingchange.com.ennexa.rating",{oldValue:b,options:this.options})},fill:function(d,b){var a=this.options,c=Math.round(d)-1,g=b?"hover":a.rated?"active":"fill",f=this.$wrapper.removeClass("rating-hover rating-active rating-fill").addClass("rating-"+
g).children();f.removeClass([a.hoverClass,a.fillClass,a.activeClass].join(" ")).addClass(a.emptyClass);f.eq(c).prevAll(".star-rating-star").addBack().removeClass(a.emptyClass).addClass(a[g+"Class"])}}});c.fn.rating=function(d){return this.each(function(){var b=c(this),a=b.data("com.ennexa.rating"),e=c.extend({},h.defaults,b.data(),"object"==typeof d&&d);a||b.data("com.ennexa.rating",a=new h(this,e));"string"==typeof d&&a[d].call(a,Array.prototype.slice.call(arguments,1))})};c(function(){c("input.star-rating").rating()})})(jQuery);